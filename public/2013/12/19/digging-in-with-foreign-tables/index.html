
<!DOCTYPE HTML>
<html>
<head>
	<meta name="google-site-verification" content="hKvGTVuUObK9oCHVB0Hg5jTgwRsTdGVZvpJfDJbwevY" />
	<script data-cfasync="false" type="text/javascript" src="//use.typekit.net/axj3cfp.js"></script>
	<script data-cfasync="false" type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<meta charset="utf-8">
	<title>Digging in with Foreign Tables - Craig Kerstiens </title>

<meta name="author" content="Craig Kerstiens"> 

<meta name="description" content="I wrote a couple months back about exploring FDWs. Its become quite clear to me, despite still having ample room for improvement, they&rsquo;re not &hellip;"> <meta name="keywords" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Craig Kerstiens" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script type="text/javascript" src="/javascripts/jquery.fancybox.pack.js"></script>

<script language="Javascript" type="text/javascript">
$(document).ready(
  function() {
    (function($) {
      $(".fancybox[data-content-id]").each(function() {
        this.href = $(this).data('content-id');
      });
      $(".fancybox").fancybox({
        beforeLoad: function() {
          var el, 
              id = $(this.element).data('title-id');

          if (id) {
            el = $('#' + id);

            if (el.length) {
              this.title = el.html();
            }
          }
          if ($(this).data('content')) {
            this.content = $(this).data('content');
          }
        },
        helpers: {
          title: {
            type: 'inside'
          }
        }
      });
    })(jQuery);
  }
);
</script>

	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">Craig Kerstiens</a></h1>
<h4></h4>
<nav id="main-nav"><ul>
	<li><a href="/about/">About</a></li>
	<li><a href="/about/travel_wine.html">Travel & Wine</a></li>
	<li><a href="/recommendations">My Recommendations</a></li>
	<li><a href="/content">Top Content</a></li>
	<li><a href="/archives">Archive</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul>
	<li><a href="/about/">About</a></li>
	<li><a href="/about/travel_wine.html">Travel & Wine</a></li>
	<li><a href="/recommendations">My Recommendations</a></li>
	<li><a href="/content">Top Content</a></li>
	<li><a href="/archives">Archive</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:www.craigkerstiens.com">
			</form>
		</div>
	</div>
</nav>


</header>

	<div id="content" class="inner"><article class="post">
	<h2 class="title">Digging in With Foreign Tables</h2>
	<div class="sharing">
	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	<a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
	
<!---	<a class="addthis_counter addthis_pill_style"></a> --->
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>

	</div>
	<div class="entry-content"><p>I wrote a couple months back about exploring FDWs. Its become quite clear to me, despite still having ample room for improvement, they&rsquo;re not getting enough attention. Foreign data wrappers are perhaps better thought of as a foreign table, or even better yet as a view into some remote data source. They don&rsquo;t take care of auto-updating or syncing data, thats all up to you, but it gives you a straight forward mapping to work with remote data easier.</p>

<p>The first step in working with FDWs is getting them setup. I wrote an earlier post on how to do this manually. And if you&rsquo;re on Heroku theres an even easier solution if you want to setup a mapping entirely from one DB to another. The <a href="">pg-extras CLI plugin</a> has a command <code>fdwsql</code> which will generate the SQL to map all the tables for you. To run it simply specify the prefix app and database:</p>

<pre><code>heroku pg:fdwsql yourprefix APP::DATABASE_URL
</code></pre>

<p>This will generate a lot of SQL. From here you&rsquo;ll want to connect to the database where you want those foreign tables to be visible. Then run all the SQL. This will create all the foreign tables, this will mostly look just like another view or table to you in <code>\d</code>.</p>

<h3>Tips on working with them</h3>

<p>For the most part you can work with your foreign tables just like any other view or table. You can insert into them, read from them, join against them. Though currently foreign tables have some performance limitations, such as when joining it may return a lot more data than you expect then join. To make your performance a bit more ideal you can follow a few basic principles.</p>

<p>Lets look at some example tables to highlight this:</p>

<pre><code>&gt; \d 
 users
 todos
</code></pre>

<p>In this case users is local and the todos are a foreign table. Looking at each of the schemas we have something like you might expect:</p>

<pre><code>&gt; \d users
                   Table "public.users"
    Column    |            Type             | Modifiers
 -------------+-----------------------------+-----------
  id          | integer                     | not null
  email       | text                        |
  created_at  | timestamp without time zone |
 Indexes:
     "users_pkey" PRIMARY KEY, btree (id)
     "users_created" btree (created_at)


&gt; \d todo
               Foreign Table "public.todo"
    Column    |            Type             | Modifiers
 -------------+-----------------------------+-----------
  id          | integer                     | not null
  user_id     | integer                     |
  desc        | text                        |
  created_at  | timestamp without time zone |
  status      | boolean                     |
 Indexes:
     "users_pkey" PRIMARY KEY, btree (id)
     "todo_created" btree (created_at)
</code></pre>
</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-12-19T00:00:00-08:00" pubdate data-updated="true"></time></div>
	

<div class="tags">

	<a class='category' href='/categories/postgresql/'>PostgreSQL</a>, <a class='category' href='/categories/postgres/'>Postgres</a>, <a class='category' href='/categories/sql/'>SQL</a>

</div>


	
</div></article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	<a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
	
<!---	<a class="addthis_counter addthis_pill_style"></a> --->
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>


</div>
	<footer id="footer" class="inner">Copyright &copy; 2017

    Craig Kerstiens

</footer>
	<script src="/javascripts/slash.js"></script>
<!--<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script>  Delete or comment this line to disable Fancybox -->




	<script type="text/javascript">
		var _gaq = _gaq || [];
		var pluginUrl = '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
		_gaq.push(['_require', 'inpage_linkid', pluginUrl]);
		_gaq.push(['_setAccount', 'UA-4670852-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>
