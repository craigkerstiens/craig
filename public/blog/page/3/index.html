
<!DOCTYPE HTML>
<html>
<head>
	<meta name="google-site-verification" content="hKvGTVuUObK9oCHVB0Hg5jTgwRsTdGVZvpJfDJbwevY" />
	<script data-cfasync="false" type="text/javascript" src="//use.typekit.net/axj3cfp.js"></script>
	<script data-cfasync="false" type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<meta charset="utf-8">
	<title> Craig Kerstiens</title>

<meta name="author" content="Craig Kerstiens"> 

<meta name="description" content="Just as PostgreSQL 9.3 was coming out I had a need to take advantage of the JSON datatype and some of the operators and functions within it. The use &hellip;"> <meta name="keywords" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Craig Kerstiens" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script type="text/javascript" src="/javascripts/jquery.fancybox.pack.js"></script>

<script language="Javascript" type="text/javascript">
$(document).ready(
  function() {
    (function($) {
      $(".fancybox[data-content-id]").each(function() {
        this.href = $(this).data('content-id');
      });
      $(".fancybox").fancybox({
        beforeLoad: function() {
          var el, 
              id = $(this.element).data('title-id');

          if (id) {
            el = $('#' + id);

            if (el.length) {
              this.title = el.html();
            }
          }
          if ($(this).data('content')) {
            this.content = $(this).data('content');
          }
        },
        helpers: {
          title: {
            type: 'inside'
          }
        }
      });
    })(jQuery);
  }
);
</script>

	
    <meta property="twitter:card" content="summary">
    <meta property="twitter:site" content="craigkerstiens">
    <meta property="twitter:url" content="http://www.craigkerstiens.com">
    <meta property="twitter:title" content="Craig Kerstiens">
    <meta property="twitter:description" content="Just as PostgreSQL 9.3 was coming out I had a need to take advantage of the JSON datatype and some of the operators and functions within it. The use case was pretty simple, run a query across a &hellip;">

</head>


<body>
	<header id="header" class="inner"><h1><a href="/">Craig Kerstiens</a></h1>
<h4></h4>
<nav id="main-nav"><ul>
	<li><a href="/about/">About</a></li>
	<li><a href="/about/travel_wine.html">Travel & Wine</a></li>
	<li><a href="/recommendations">My Recommendations</a></li>
	<li><a href="/content">Top Content</a></li>
	<li><a href="/archives">Archive</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul>
	<li><a href="/about/">About</a></li>
	<li><a href="/about/travel_wine.html">Travel & Wine</a></li>
	<li><a href="/recommendations">My Recommendations</a></li>
	<li><a href="/content">Top Content</a></li>
	<li><a href="/archives">Archive</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:www.craigkerstiens.com">
			</form>
		</div>
	</div>
</nav>


</header>

	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/2013/09/11/diving-into-postgres-json-operators/">
		
			Diving Into Postgres JSON Operators and Functions</a>
	</h2>
	<div class="entry-content">
		<p>Just as <a href="https://postgres.heroku.com/blog/past/2013/9/9/postgres_93_now_available/">PostgreSQL 9.3</a> was coming out I had a need to take advantage of the JSON datatype and some of the <a href="http://www.postgresql.org/docs/9.3/static/functions-json.html">operators and functions</a> within it. The use case was pretty simple, run a query across a variety of databases, then take the results and store them. We explored doing something more elaborate with the columns/values, but in the end just opted to save the entire result set as JSON then I could use the operators to explore it as desired.</p>

<p>Here&rsquo;s the general idea in code (using sequel):</p>

<pre><code>result = r.connection { |c| c.fetch(self.query).all }
mymodel.results = result.to_json
</code></pre>


		
		<a href="/2013/09/11/diving-into-postgres-json-operators/" class="more-link">Read on </a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-09-11T00:00:00-07:00" pubdate data-updated="true"></time></div>
	

<div class="tags">

	<a class='category' href='/categories/postgresql/'>PostgreSQL</a>, <a class='category' href='/categories/postgres/'>Postgres</a>

</div>


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2013/08/13/rule-of-thirds/">
		
			The Rule of Thirds - Followup</a>
	</h2>
	<div class="entry-content">
		<p>Several months back I wrote about how we do <a href="http://www.craigkerstiens.com/2013/03/13/planning-and-prioritizing/">higher level, long term planning within the Heroku Postgres team</a>. If you haven&rsquo;t read the previous article please start there.</p>

<p>The exercise or rule of thirds is intended to be approximate prioritization and not a perfect science. Since that time I&rsquo;m familiar with some teams both in and out of Heroku who have attempted this exercise with varying levels of success. We&rsquo;ve now done this process 4 times within the team and after the most recent exercise attempted to take some time to internalize why its worked well, creating some more specifics about the process. Heres an attempt to provide even more clarity:</p>


		
		<a href="/2013/08/13/rule-of-thirds/" class="more-link">Read on </a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-08-13T00:00:00-07:00" pubdate data-updated="true"></time></div>
	

<div class="tags">

	<a class='category' href='/categories/heroku/'>Heroku</a>

</div>


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2013/08/07/the-missing-postgresql-documentation/">
		
			The Missing PostgreSQL Documentation</a>
	</h2>
	<div class="entry-content">
		<p>For a couple of years I&rsquo;ve complained about the Postgres documentation and at the same time paraded it as one of the best sets of documentation I&rsquo;ve encountered. In many ways the reason I veer towards <a href="http://www.postgresql.org">Postgres</a> as well as <a href="http://www.python.org">Python</a> and <a href="http://www.djangoproject.com">Django</a> is the quality of their documentation. If you need to find details about something its documented, and more importantly well and thoroughly documented.</p>

<p>In large part I came to Python by happenstance through <a href="http://www.djangoproject.com">Django</a>, and Postgres through happenstance of an employer. Yet, Django was very little of an accident. The Django Tutorial got me a large part of what I needed to know and more excited about development than I had been in some time. Python has done some work at adding docs to make this even better, sadly its still very much needed for PostgreSQL.</p>


		
		<a href="/2013/08/07/the-missing-postgresql-documentation/" class="more-link">Read on </a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-08-07T00:00:00-07:00" pubdate data-updated="true"></time></div>
	

<div class="tags">

	<a class='category' href='/categories/postgresql/'>PostgreSQL</a>, <a class='category' href='/categories/postgres/'>Postgres</a>, <a class='category' href='/categories/sql/'>SQL</a>

</div>


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2013/08/05/a-look-at-FDWs/">
		
			A Look at Foreign Data Wrappers</a>
	</h2>
	<div class="entry-content">
		<p>There are two particular sets of features that continue to keep me very excited about the momentum of Postgres. And while PostgreSQL has had some great momentum in the past few years these features may give it an entirely new pace all together. One is extensions, which is really its own category. Dimitri Fontaine was talking about doing a full series just on extensions, so here&rsquo;s hoping he does so I dont have to :)</p>

<p>One subset of extensions which I consider entirely separate is the other thing, which is foreign data wrappers or FDWs. FDWs allow you to connect to other data sources from within Postgres. From there you can query them with SQL, join across disparate data sets, or join across different systems. Recently I had a good excuse to give the <code>postgres_fdw</code> a try. And while I&rsquo;ve blogged about the Redis FDW previously, the Postgres one is particularly exciting because with PostgreSQL 9.3 it will ship as a contrib module, which means all Postgres installers should have it&hellip; you just have to turn it on.</p>


		
		<a href="/2013/08/05/a-look-at-FDWs/" class="more-link">Read on </a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-08-05T00:00:00-07:00" pubdate data-updated="true"></time></div>
	

<div class="tags">

	<a class='category' href='/categories/postgresql/'>PostgreSQL</a>, <a class='category' href='/categories/postgres/'>Postgres</a>, <a class='category' href='/categories/sql/'>SQL</a>

</div>


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2013/08/02/use-dollar-quoting-anywhere/">
		
			Postgres Dollar Quoting</a>
	</h2>
	<div class="entry-content">
		<p>After my most recent post on <a href="/2013/07/29/documenting-your-postgres-database/">documenting your database</a> I had a colleague and friend chime in:</p>

<blockquote><p>@craigkerstiens You may want to mention for another post the generality of dollar quoting: it&#8217;s not just for CREATE FUNCTION.</p><footer><strong>@danfarina</strong> <cite><a href='https://twitter.com/danfarina/status/362007008079126528'>twitter.com/danfarina/status/&hellip;</a></cite></footer></blockquote>


<p>Luckily I was able to convince him to create the post. You can read a bit more on him below, but without further adieu here&rsquo;s a bit on dollar quoting within Postgres:</p>


		
		<a href="/2013/08/02/use-dollar-quoting-anywhere/" class="more-link">Read on </a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-08-02T00:00:00-07:00" pubdate data-updated="true"></time></div>
	

<div class="tags">

	<a class='category' href='/categories/postgresql/'>PostgreSQL</a>, <a class='category' href='/categories/postgres/'>Postgres</a>, <a class='category' href='/categories/sql/'>SQL</a>

</div>


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2013/07/29/documenting-your-postgres-database/">
		
			Documenting Your PostgreSQL Database</a>
	</h2>
	<div class="entry-content">
		<p>Just a few days ago I was surprised by what someone was doing with their database, and not in the typical horrifying travesty against mankind. Rather, it was a feature that while familiar with I&rsquo;d never seen anyone fully take proper advantage of &ndash; <code>COMMENT</code> or describing tables. Postgres has a nice facility for you to provide a description for just about anything:</p>

<ul>
<li>Table</li>
<li>Column</li>
<li>Function</li>
<li>Schema</li>
<li>View</li>
<li>Index</li>
<li>Etc.</li>
</ul>



		
		<a href="/2013/07/29/documenting-your-postgres-database/" class="more-link">Read on </a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-07-29T00:00:00-07:00" pubdate data-updated="true"></time></div>
	

<div class="tags">

	<a class='category' href='/categories/postgresql/'>PostgreSQL</a>, <a class='category' href='/categories/postgres/'>Postgres</a>, <a class='category' href='/categories/sql/'>SQL</a>

</div>


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2013/07/03/hstore-vs-json/">
		
			Hstore vs. JSON - Which to Use in Postgres</a>
	</h2>
	<div class="entry-content">
		<p>If you&rsquo;re deciding what to put in <a href="http://www.amazon.com/Seven-Databases-Weeks-Modern-Movement/dp/1934356921?tag=mypred-20">Postgres and what not to</a>, consider that Postgres can be a <a href="/2012/06/11/schemaless-django/">perfectly good schema-less database</a>. Of course as soon as people realized this then the common comes a question, is hstore or JSON better. Which do I use and in what cases. Well first, if you&rsquo;re not familiar check out some previous material on them:</p>

<ul>
<li><a href="http://www.postgresql.org/docs/9.2/static/hstore.html">hstore on PostgresGuide</a></li>
<li><a href="http://www.postgresql.org/docs/9.2/static/hstore.html">hstore in Postgres docs</a></li>
<li><a href="http://www.craigkerstiens.com/2012/06/11/schemaless-django/">hstore with Django</a></li>
<li><a href="http://wiki.postgresql.org/wiki/What's_new_in_PostgreSQL_9.2#JSON_datatype">JSON datatype</a></li>
<li><a href="https://postgres.heroku.com/blog/past/2013/6/5/javascript_in_your_postgres/">JavaScript support in Postgres</a></li>
</ul>


<p>If you&rsquo;re already up to date with both of them, but still wondering which to use lets dig in.</p>


		
		<a href="/2013/07/03/hstore-vs-json/" class="more-link">Read on </a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-07-03T00:00:00-07:00" pubdate data-updated="true"></time></div>
	

<div class="tags">

	<a class='category' href='/categories/postgresql/'>PostgreSQL</a>, <a class='category' href='/categories/postgres/'>Postgres</a>, <a class='category' href='/categories/sql/'>SQL</a>

</div>


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2013/06/27/Pivoting-in-Postgres/">
		
			Pivoting in Postgres</a>
	</h2>
	<div class="entry-content">
		<p>Earlier today on an internal Heroku group alias there was a <a href="https://postgres.heroku.com/dataclips">dataclip</a> shared. The dataclip listed off some data grouped by a category, there was a reply a few minutes later with a modification to the query that used the <code>crosstab</code> function to pivot directly in SQL. There were immediately several reactions on the list that went something like this:</p>

<p><img src="http://f.cl.ly/items/1b0G101r0B2W243b2933/Image%202013.06.27%202%3A06%3A23%20PM.gif" alt="mindblown" /></p>

<p>While a mostly simple function in Postgres (there are a few rough edges), it really is all too handy. So here it is in action. Taking some data that looks like</p>

<ul>
<li>row identifier, in this case date</li>
<li>category grouping, in this case OS</li>
<li>value</li>
</ul>



		
		<a href="/2013/06/27/Pivoting-in-Postgres/" class="more-link">Read on </a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-06-27T00:00:00-07:00" pubdate data-updated="true"></time></div>
	

<div class="tags">

	<a class='category' href='/categories/postgresql/'>PostgreSQL</a>, <a class='category' href='/categories/postgres/'>Postgres</a>, <a class='category' href='/categories/sql/'>SQL</a>

</div>


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2013/06/25/javascript-functions-for-postgres/">
		
			Javascript Functions for PostgreSQL</a>
	</h2>
	<div class="entry-content">
		<p>Javascript in Postgres has gotten a good bit of love lately, part of that is from <a href="http://postgres.herpku.com">Heroku Postgres</a> recently <a href="https://postgres.heroku.com/blog/past/2013/6/5/javascript_in_your_postgres/">adding support for Javascript</a> and part from a variety of people championing the power of it such as <a href="http://twitter.com/leinweber">@leinweber</a> (<a href="http://www.youtube.com/watch?v=fRupMAVdmWA">Embracing the web with JSON and PLV8</a>) and <a href="http://twitter.com/selenamarie">@selenamarie</a> (<a href="https://speakerdeck.com/selenamarie/schema-liberation-with-json-and-plv8-and-postgres">schema liberation with JSON and PLV8</a>). In a recent conversation it was pointed out that it seems a bit of headache to have to create your own functions, or at least having an initial collection would make it that much more powerful. While many can look forward to <a href="http://www.postgresql.org/docs/9.3/static/functions-json.html">PostgreSQL 9.3</a> which will have a bit more built in support for JSON a few functions can really help make it more useful today.</p>


		
		<a href="/2013/06/25/javascript-functions-for-postgres/" class="more-link">Read on </a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-06-25T00:00:00-07:00" pubdate data-updated="true"></time></div>
	

<div class="tags">

	<a class='category' href='/categories/postgres/'>Postgres</a>, <a class='category' href='/categories/sql/'>SQL</a>

</div>


	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2013/06/13/explaining-your-data/">
		
			Explaining Your PostgreSQL Data</a>
	</h2>
	<div class="entry-content">
		<p>I&rsquo;ve written a bit before about <a href="http://www.craigkerstiens.com/2013/01/10/more-on-postgres-performance/">understanding the output</a> from <code>EXPLAIN</code> and <code>EXPLAIN ANALYZE</code> in PostgreSQL. Though understandably getting a grasp on execution plans could probably use some more guidance. Yet, this time around I&rsquo;m taking a bit of a cop out and highlighting a few tools instead of documenting myself, which I&rsquo;ve done in a talk I&rsquo;ve frequently given <a href="https://speakerdeck.com/craigkerstiens/postgres-demystified-1">Postgres Demystified</a>.</p>

<p><img src="http://f.cl.ly/items/2Y0A0H2B2q3C0622261C/Screenshot_6_13_13_9_57_AM.png" alt="Explain explained" /></p>


		
		<a href="/2013/06/13/explaining-your-data/" class="more-link">Read on </a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-06-13T00:00:00-07:00" pubdate data-updated="true"></time></div>
	

<div class="tags">

	<a class='category' href='/categories/postgres/'>Postgres</a>, <a class='category' href='/categories/sql/'>SQL</a>

</div>


	
</div></article>

<nav id="pagenavi">
    
        <a href="/blog/page/2/" class="prev">Prev</a>
    
    
        <a href="/blog/page/4/" class="next">Next</a>
    
    <div class="center"><a href="/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2014

    Craig Kerstiens

</footer>
	<script src="/javascripts/slash.js"></script>
<!--<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script>  Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'craigkerstiens';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		var pluginUrl = '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
		_gaq.push(['_require', 'inpage_linkid', pluginUrl]);
		_gaq.push(['_setAccount', 'UA-4670852-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>
